package main // import "github.com/nutmegdevelopment/flowlog-exporter"

import (
	"bytes"
	"compress/gzip"
	"io"
	"io/ioutil"
	"net"
	"testing"

	"github.com/stretchr/testify/assert"
)

func init() {
	metrics.Register()
}

func TestSubnetLookup(t *testing.T) {
	s := new(Subnets)

	_, n, err := net.ParseCIDR("10.1.2.0/24")
	assert.NoError(t, err)

	s.networks = append(s.networks, n)

	inside := net.ParseIP("10.1.2.3")
	outside := net.ParseIP("10.1.3.4")

	res, in := s.Lookup(inside)
	assert.True(t, in)
	assert.Equal(t, "10.1.2.0/24", res)

	res, in = s.Lookup(outside)
	assert.False(t, in)
	assert.Empty(t, res)
}

func BenchmarkSubnetLookup(b *testing.B) {

	s := new(Subnets)

	_, n, err := net.ParseCIDR("10.1.2.0/24")
	if err != nil {
		b.Fatal(err)
	}

	s.networks = append(s.networks, n)

	inside := net.ParseIP("10.1.2.3")

	for i := 0; i < b.N; i++ {
		s.Lookup(inside)
	}
}

func TestDecompress(t *testing.T) {

	buf := new(bytes.Buffer)
	w := gzip.NewWriter(buf)
	w.Write(testData)
	w.Close()

	in := make(chan []byte)
	out := make(chan io.Reader)

	go Decompress(in, out)

	go func() {
		in <- buf.Bytes()
		close(in)
	}()

	r := <-out
	res, err := ioutil.ReadAll(r)
	assert.NoError(t, err)
	assert.Equal(t, testData, res)
}

func BenchmarkDecompress(b *testing.B) {

	buf := new(bytes.Buffer)
	w := gzip.NewWriter(buf)
	w.Write(testData)
	w.Close()

	in := buf.Bytes()

	for i := 0; i < b.N; i++ {
		decompress(in)
	}
}

func TestDecode(t *testing.T) {

	in := make(chan io.Reader)
	out := make(chan FlowLogEvent)

	go Decode(in, out)

	go func() {
		in <- bytes.NewReader(testData)
		close(in)
	}()

	res := <-out
	assert.Equal(t, 139, len(res.LogEvents))
}

func BenchmarkDecode(b *testing.B) {

	for i := 0; i < b.N; i++ {
		decode(bytes.NewReader(testData))
	}
}

func TestParseMessage(t *testing.T) {

	testInput := `2 217746932756 eni-12345678 10.100.1.2 10.100.2.3 80 25901 6 2 112 1466176699 1466176812 ACCEPT OK`
	f, err := ParseMessage(testInput)
	assert.NoError(t, err)

	assert.True(t, f.Accepted)
	assert.Equal(t, "10.100.1.2", f.Src.String())
	assert.Equal(t, 80, f.SrcPort)
}

func BenchmarkParseMessage(b *testing.B) {

	testInput := `2 217746932756 eni-12345678 10.100.1.2 10.100.2.3 80 25901 6 2 112 1466176699 1466176812 ACCEPT OK`

	for i := 0; i < b.N; i++ {
		ParseMessage(testInput)
	}
}

func TestProcessFlowLog(t *testing.T) {

	msg, err := decode(bytes.NewReader(testData))
	assert.NoError(t, err)

	ch := make(chan FlowMessage)

	err = msg.ProcessFlowLog(ch)
	assert.NoError(t, err)
}

func BenchmarkProcessFlowLog(b *testing.B) {

	msg, _ := decode(bytes.NewReader(testData))

	ch := make(chan FlowMessage)

	for i := 0; i < b.N; i++ {
		msg.ProcessFlowLog(ch)
	}
}

func TestFull(t *testing.T) {
	s := new(Subnets)
	_, n, err := net.ParseCIDR("10.0.0.0/8")
	assert.NoError(t, err)

	s.networks = append(s.networks, n)

	buf := new(bytes.Buffer)
	w := gzip.NewWriter(buf)
	w.Write(testData)
	w.Close()

	in := buf.Bytes()
	ch := make(chan FlowMessage)

	r, err := decompress(in)
	assert.NoError(t, err)

	event, err := decode(r)
	assert.NoError(t, err)

	err = event.ProcessFlowLog(ch)
	assert.NoError(t, err)
}

func BenchmarkFull(b *testing.B) {
	s := new(Subnets)
	_, n, _ := net.ParseCIDR("10.0.0.0/8")
	s.networks = append(s.networks, n)

	buf := new(bytes.Buffer)
	w := gzip.NewWriter(buf)
	w.Write(testData)
	w.Close()

	in := buf.Bytes()
	ch := make(chan FlowMessage)

	for i := 0; i < b.N; i++ {
		r, _ := decompress(in)
		event, _ := decode(r)
		event.ProcessFlowLog(ch)
	}

}

var testData = []byte(`
{"messageType":"DATA_MESSAGE","owner":"1234567890","logGroup":"network-logs","logStream":"eni-12345678-all","subscriptionFilters":["cloudwatch_to_kinesis_network_test"],"logEvents":[{"id":"32700267005272614824908230066198952485659061324041748480","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 123.4.206.108 10.100.21.62 43520 13899 17 2 116 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748481","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 182.142.39.181 10.100.21.62 1026 21556 17 3 228 1466330686 1466330803 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748482","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 1234 14524 6 4 495 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748483","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31852 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748484","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33166 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748485","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 74.82.47.59 80 33236 6 1 44 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748486","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 32830 6 10 22315 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748487","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33131 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748488","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31887 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748489","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33115 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748490","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31877 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748491","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 189.253.209.171 10.100.21.62 36121 23 6 3 156 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748492","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31854 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748493","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31877 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748494","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31867 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748495","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 52.49.7.56 443 58966 6 42 50617 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748496","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31870 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748497","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33134 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748498","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33130 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748499","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33745 1234 6 1 173 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748500","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33156 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748501","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31903 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748502","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 123.4.206.108 10.100.21.62 63983 13899 6 2 100 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748503","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33143 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748504","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33165 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748505","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 52.49.7.56 10.100.21.62 58966 443 6 35 5474 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748506","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31571 6 11 26860 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748507","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33135 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748508","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33118 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748509","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31903 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748510","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31870 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748511","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31902 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748512","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31886 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748513","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 1234 14491 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748514","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31889 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748515","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33124 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748516","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31867 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748517","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31878 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748518","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 192.88.99.255 0 0 41 2 248 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748519","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 1234 33778 6 4 495 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748520","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33116 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748521","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33131 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748522","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33135 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748523","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31889 6 3 164 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748524","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33159 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748525","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31852 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748526","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 14.157.72.235 10.100.21.62 16007 13414 17 1 132 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748527","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31908 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748528","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33160 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748529","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31912 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748530","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31878 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748531","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31851 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748532","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33165 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748533","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31868 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748534","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 14491 1234 6 1 173 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748535","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31886 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748536","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33108 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748537","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31912 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748538","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31913 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748539","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33116 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748540","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33108 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748541","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31868 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748542","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33118 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748543","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33143 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748544","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 123.65.215.100 10.100.21.62 27046 18759 6 2 120 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748545","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33124 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748546","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33155 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748547","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31862 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748548","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31851 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748549","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33156 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748550","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33130 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748551","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33160 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748552","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31902 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748553","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33778 1234 6 5 510 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748554","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 1234 33745 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748555","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 14524 1234 6 5 510 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748556","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 157.122.148.223 10.100.21.62 33777 29556 6 1 48 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748557","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31909 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748558","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31908 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748559","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31887 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748560","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31571 80 6 22 3861 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748561","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31862 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748562","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33115 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748563","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 32830 80 6 20 3510 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748564","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31909 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748565","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 74.82.47.59 10.100.21.62 33236 80 6 2 80 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748566","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31854 80 6 2 104 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748567","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31913 6 2 112 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748568","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 157.122.148.223 10.100.21.62 10101 29556 6 1 52 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748569","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 115.44.232.246 10.100.21.62 58707 24905 6 2 104 1466330686 1466330742 REJECT OK"},{"id":"32700267005272614824908230066198952485659061324041748570","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33159 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748571","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33155 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748572","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33134 6 1 52 1466330686 1466330742 ACCEPT OK"},{"id":"32700267005272614824908230066198952485659061324041748573","timestamp":1466330686000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33166 80 6 4 216 1466330686 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292574","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31936 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292575","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33190 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292576","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33174 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292577","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31930 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292578","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33192 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292579","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 113.200.235.38 10.100.21.62 53 54793 17 1 116 1466330745 1466330803 REJECT OK"},{"id":"32700268321016581538214995416806330571912390176886292580","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33184 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292581","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31921 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292582","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31948 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292583","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33174 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292584","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33178 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292585","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31928 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292586","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33178 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292587","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31947 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292588","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 123.4.206.108 10.100.21.62 64807 13899 6 3 152 1466330745 1466330803 REJECT OK"},{"id":"32700268321016581538214995416806330571912390176886292589","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31943 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292590","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31921 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292591","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31944 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292592","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31936 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292593","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 182.142.39.181 10.100.21.62 10700 21556 6 3 152 1466330745 1466330803 REJECT OK"},{"id":"32700268321016581538214995416806330571912390176886292594","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33189 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292595","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33175 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292596","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33201 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292597","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 116.234.152.154 10.100.21.62 3013 22889 6 3 156 1466330745 1466330803 REJECT OK"},{"id":"32700268321016581538214995416806330571912390176886292598","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33189 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292599","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33201 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292600","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33200 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292601","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33175 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292602","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31922 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292603","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31947 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292604","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 1234 14561 6 3 443 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292605","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33190 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292606","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 14561 1234 6 4 337 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292607","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31948 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292608","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31944 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292609","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31928 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292610","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33815 1234 6 4 337 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292611","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33192 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292612","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.2.157 31922 80 6 2 112 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292613","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31930 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292614","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.2.157 10.100.21.62 80 31943 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292615","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 1234 33815 6 3 443 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292616","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.1.144 10.100.21.62 80 33200 6 1 60 1466330745 1466330803 ACCEPT OK"},{"id":"32700268321016581538214995416806330571912390176886292617","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 123.4.206.108 10.100.21.62 44457 13899 17 2 116 1466330745 1466330803 REJECT OK"},{"id":"32700268321016581538214995416806330571912390176886292618","timestamp":1466330745000,"message":"2 1234567890 eni-12345678 10.100.21.62 10.100.1.144 33184 80 6 2 112 1466330745 1466330803 ACCEPT OK"}]}
`)
